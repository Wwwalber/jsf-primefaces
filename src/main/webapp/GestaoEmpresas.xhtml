<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      template="WEB-INF/template/Layout.xhtml">

      <ui:remove>a tag html agora</ui:remove>
      <!-- diferencia prefixo jsf vs. html -->
<!-- Seus componentes JSF aqui -->
<ui:remove>head e header não precisamos mais aqui porque já está no template</ui:remove>

<ui:define name="titulo">
    Cadastro de Empresas
</ui:define>
<ui:remove>a tag body agora</ui:remove> <ui:remove>renderidado no tamplate na posição de mesmo 'name'</ui:remove>
<ui:define name="conteudo"> <ui:remove>será renderidado no tamplate na posição de mesmo 'name'</ui:remove>
    <ui:remove>chamada do método para preencher a dataTable</ui:remove>
    <f:metadata>
        <f:viewAction action="#{gestaoEmpresasBean.todasEmpresas}" />
    </f:metadata>

    <h:form>
        <p:messages />
        <p:toolbar id="toolbar">
            <f:facet name="left">
                <p:inputText placeholder="Digite aqui um termo para pesquisa..." 
                size="30" value="#{gestaoEmpresasBean.termoPesquisa}"/>
            
            <p:commandButton value="Pesquisar" icon="fa fa-search"
                actionListener="#{gestaoEmpresasBean.pesquisar}" update="empresasDataTable"/>
            
            <span class="ui-separator">
                <span class="ui-icon ui-icon-grip-dotted-vertical" />
            </span>

                <p:commandButton value="Nova" icon="fa fa-plus" 
                onclick="PF('empresaDialogWidgetVar').show()" />

                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>     
                
                <p:commandButton title="Editar" icon="fa fa-edit"/> 
    
                <p:commandButton title="Excluir" icon="fa fa-trash"/>
    
                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>  
    
                <p:commandButton title="Exportar para o Excel" icon="fa fa-file-excel-o"/>
            </f:facet>

        </p:toolbar>
        <p:spacer height="20px" />

        <p:dataTable  id="empresasDataTable" value="#{gestaoEmpresasBean.listaEmpresas}"
            var="empresa" emptyMessage="Nenhuma informação a ser exibida"
            paginator="true" rows="4" paginatorPosition="bottom"  ><ui:remove>a variável 'empresa' tem acesso lá na classe Java a entidade Empresa</ui:remove>
           
            <p:column headerText="Razão Social" sortBy="#{empresa.razaoSocial}">
                <h:outputText value="#{empresa.razaoSocial}" />
            </p:column>

            <p:column headerText="Nome Fantasia">
                <h:outputText value="#{empresa.nomeFantasia}" />
            </p:column>

            <p:column headerText="Tipo Empresa">
                <h:outputText value="#{empresa.tipo}" />
            </p:column>

            
            <p:column headerText="Ramo Atividade">
                <h:outputText value="#{empresa.ramoAtividade.descricao}" />
            </p:column>
        </p:dataTable>
                           <ui:remove>widgetVar - espécie de variável usada para acessar dialog no cliente via JavaScript</ui:remove>     
        <p:dialog header="Nova empresa" widgetVar="empresaDialogWidgetVar" modal="true"
            resizable="false" closeOnEscape="true" >
        <h:panelGrid columns="2">
            <p:outputLabel value="Razão Social" for="razaoSocial" />
            <p:inputText id="razaoSocial" size="80" maxlength="120" />

            <p:outputLabel value="Nome Fantasia" for="nomeFantasia" />
            <p:inputText id="nomeFantasia" size="80" maxlength="120" />

            <p:outputLabel value="Tipo empresa" for="tipo"/>
            <p:selectOneMenu id="tipo">
                <f:selectItem itemLabel="Selecione..."/>
                <f:selectItems value="#{gestaoEmpresasBean.tipoEmpresa}"
                var="tipoEmpresa" itemLabel="#{tipoEmpresa.descricao}"
                itemValue="#{tipoEmpresa}"/>
                <ui:remove>
                    var - pega cada posição em tipo empresa 
                    itemLabel - configura o que o usuário vai variável (vem do enum por meio do get)
                    itemValue - valor a ser enviado p/ o meneagBean
                </ui:remove>     
            </p:selectOneMenu>

            <p:outputLabel value="CNPJ: " for="cnpj" />
            <p:inputMask id="cnpj" mask="99.999.999/999-99" size="18" maxlength="18"/>

            <p:outputLabel value="Data Fundação" for="dataFundacao"/>
            <p:calendar id="dataFundacao" pattern="dd/MM/yyyy" size="30" />

            <p:outputLabel value="Ramo Atividade" for="ramoAtividade"/>           
            <p:autoComplete id="ramoAtividade" size="80" />

            <h:outputLabel /><ui:remove>somente para ocupar a coluna e assim ajustar a posição do botão</ui:remove>
            <p:commandButton value="Salvar" />
        </h:panelGrid>
        </p:dialog>
    </h:form>
</ui:define>
</ui:composition>